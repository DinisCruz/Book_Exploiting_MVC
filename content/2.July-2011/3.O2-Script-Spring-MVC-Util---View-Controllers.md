## O2 Script: 'Spring MVC Util - View Controllers'

This Script creates a view for the Spring MVC mapping objects created by the SpringMvcMappings_v2 API. This is a very important script since it provides a very clear view of a Spring MVC application URLs, Controllers and CommandClass The Command Class view can be quite spectacular since it is common to find massive AutoBinded POJOs (some even with recursion) Here is a video showing this script in action: [youtube=http://www.youtube.com/watch?v=ZQd7xqAlSRc] Here is the code: [sourcecode language="csharp" wraplines="false"] var topPanel = O2Gui.open&amp;lt;Panel&amp;gt;(&amp;quot;Spring MVC Util - View Controllers&amp;quot;,1000,400); //var topPanel = panel.clear().add_Panel();&amp;lt;/pre&amp;gt; &amp;amp;nbsp; var baseDir = PublicDI.CurrentScript.directoryName(); var xmlFile = baseDir.pathCombine(@&amp;quot;sourceCode\war\WEB-INF\petstore-servlet.xml&amp;quot;); var mcvMappingsFile = &amp;quot;{0}.mvcMappings.xml&amp;quot;.format(xmlFile); var webAppClassFiles = baseDir.pathCombine(&amp;quot;jPetStore.classes.zip.xml&amp;quot;); var coreClassFiles = baseDir.pathCombine(&amp;quot;jPetStore.classes.zip.xml&amp;quot;); Func&amp;lt;string,string,string&amp;gt; resolveGetterReturnType = (methodName, returnType) =&amp;gt; { &amp;quot;in resolveGetterReturnType: {0}  -    {1}&amp;quot;.debug(methodName, returnType); if (methodName ==&amp;quot;getLineItems&amp;quot;) return &amp;quot;org.springframework.samples.jpetstore.domain.LineItem&amp;quot;; return returnType; }; var mvcMappings = (mcvMappingsFile.fileExists()) ? mcvMappingsFile.load&amp;lt;SpringMvcMappings&amp;gt;() : xmlFile.springMvcMappings() .mapCommandClass_using_XRefs(webAppClassFiles); var xRefs = coreClassFiles.javaMetadata().map_JavaMetadata_XRefs(); var byCommandClass = mvcMappings.controllers_by_CommandClass(); var treeView = topPanel.add_TreeView_with_PropertyGrid(true).sort(); var codeViewer = topPanel.insert_Right().add_SourceCodeViewer(); Action&amp;lt;string&amp;gt; onClassSelected = (@class) =&amp;gt; { if (xRefs.Classes_by_Signature.hasKey(@class)) codeViewer.open(xRefs.Classes_by_Signature[@class].file()); }; var _treeView = codeViewer.insert_Above().add_TreeView_For_CommandClasses_Visualization(xRefs, onClassSelected, resolveGetterReturnType); treeView.afterSelect&amp;lt;String&amp;gt;( (javaClass)=&amp;gt;{ if (javaClass.valid() &amp;amp;&amp;amp; javaClass !=&amp;quot;[no commandName]&amp;quot;) { var file = &amp;quot;{0}.java&amp;quot;.format(javaClass.replace(&amp;quot;.&amp;quot;,&amp;quot;\\&amp;quot;)); _treeView.clear(); _treeView.add_Node(javaClass, javaClass,true); codeViewer.open(file); } else codeViewer.set_Text(&amp;quot;&amp;quot;); }); treeView.afterSelect&amp;lt;SpringMvcController&amp;gt;( (mvcController)=&amp;gt;{ if (mvcController.FileName.valid()) codeViewer.open(mvcController.FileName); _treeView.clear(); if (mvcController.CommandClass.valid()) _treeView.add_Node(mvcController.CommandClass, mvcController.CommandClass,true); }); var byCommandClassNode = treeView.add_Node(&amp;quot;by CommandClass&amp;quot;); foreach(var mapping in     byCommandClass) byCommandClassNode.add_Node(mapping.Key,mapping.Key) .add_Nodes(mapping.Value); var byJavaClassNode = treeView.add_Node(&amp;quot;by JavaClass&amp;quot;); foreach(var mapping in  mvcMappings.controllers_by_JavaClass()) byJavaClassNode.add_Node(mapping.Key,mapping.Value); var byUrlNode = treeView.add_Node(&amp;quot;by Url&amp;quot;); foreach(var controller in  mvcMappings.Controllers) byUrlNode.add_Node(controller.HttpRequestUrl,controller); treeView.focus(); return &amp;quot;ok&amp;quot;; //using O2.XRules.Database.Languages_and_Frameworks.J2EE //using O2.XRules.Database.APIs.IKVM //O2File:spring-servlet-2.0.xsd.cs //O2File:SpringMvcMappings_v2.0.cs //O2Ref:O2_Misc_Microsoft_MPL_Libs.dll [/sourcecode]
